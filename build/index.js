(()=>{"use strict";var e={n:t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.plugins,n=window.wp.data,i=window.wp.apiFetch;var s=e.n(i);const a=window.wp.editor,r="reactions-indieweb/post-kinds",o="_reactions_",l={selectedKind:null,autoDetectedKind:null,isAutoDetectionEnabled:!0,apiLookup:{isLoading:!1,results:[],error:null,type:null},availableKinds:[],isInitialized:!1},c="SET_KIND",d="SET_AUTO_DETECTED_KIND",u="ENABLE_AUTO_DETECTION",h="DISABLE_AUTO_DETECTION",p="START_API_LOOKUP",w="RECEIVE_API_RESULTS",b="API_LOOKUP_ERROR",x="CLEAR_API_RESULTS",_="SET_AVAILABLE_KINDS",g="SET_INITIALIZED",v={setKind:e=>({type:c,kind:e}),setAutoDetectedKind:e=>({type:d,kind:e}),enableAutoDetection:()=>({type:u}),disableAutoDetection:()=>({type:h}),startApiLookup:e=>({type:p,lookupType:e}),receiveApiResults:e=>({type:w,results:e}),apiLookupError:e=>({type:b,error:e}),clearApiResults:()=>({type:x}),setAvailableKinds:e=>({type:_,kinds:e}),setInitialized:()=>({type:g}),updatePostKind:e=>async({dispatch:t,registry:n})=>{const{editPost:i}=n.dispatch(a.store),s=n.select(r).getAvailableKinds().find(t=>t.slug===e);s&&await i({kind:[s.id]}),t.setKind(e)},updateKindMeta:(e,t)=>async({registry:n})=>{const{editPost:i}=n.dispatch(a.store),s=o+e;await i({meta:{[s]:t}})},performApiLookup:(e,t)=>async({dispatch:n})=>{n.startApiLookup(e);try{const i=await s()({path:`/reactions-indieweb/v1/lookup/${e}?q=${encodeURIComponent(t)}`});n.receiveApiResults(i)}catch(e){n.apiLookupError(e.message||"Lookup failed")}},initialize:()=>async({dispatch:e,registry:t})=>{try{const t=await s()({path:"/wp/v2/kind?per_page=100"});e.setAvailableKinds(t)}catch(e){console.error("Failed to fetch kinds:",e)}const n=t.select(a.store).getEditedPostAttribute("kind"),i=t.select(r).getAvailableKinds();if(n&&n.length>0&&i.length>0){const t=i.find(e=>e.id===n[0]);t&&e.setKind(t.slug)}e.setInitialized()}},m={getSelectedKind:e=>e.selectedKind,getAutoDetectedKind:e=>e.autoDetectedKind,isAutoDetectionEnabled:e=>e.isAutoDetectionEnabled,isApiLoading:e=>e.apiLookup.isLoading,getApiResults:e=>e.apiLookup.results,getApiError:e=>e.apiLookup.error,getApiLookupType:e=>e.apiLookup.type,getAvailableKinds:e=>e.availableKinds,isInitialized:e=>e.isInitialized,getKindMeta:(0,n.createRegistrySelector)(e=>(t,n)=>(e(a.store).getEditedPostAttribute("meta")||{})[o+n]||""),getAllKindMeta:(0,n.createRegistrySelector)(e=>()=>{const t=e(a.store).getEditedPostAttribute("meta")||{},n={};return Object.keys(t).forEach(e=>{if(e.startsWith(o)){const i=e.replace(o,"");n[i]=t[e]}}),n})},k=(0,n.createReduxStore)(r,{reducer:function(e=l,t){switch(t.type){case c:return{...e,selectedKind:t.kind};case d:return{...e,autoDetectedKind:t.kind};case u:return{...e,isAutoDetectionEnabled:!0};case h:return{...e,isAutoDetectionEnabled:!1};case p:return{...e,apiLookup:{isLoading:!0,results:[],error:null,type:t.lookupType}};case w:return{...e,apiLookup:{...e.apiLookup,isLoading:!1,results:t.results,error:null}};case b:return{...e,apiLookup:{...e.apiLookup,isLoading:!1,results:[],error:t.error}};case x:return{...e,apiLookup:{isLoading:!1,results:[],error:null,type:null}};case _:return{...e,availableKinds:t.kinds};case g:return{...e,isInitialized:!0};default:return e}},actions:v,selectors:m}),f=window.wp.i18n,j=window.wp.element,C=window.wp.blockEditor,y=window.wp.components,S=window.wp.primitives,A=window.ReactJSXRuntime,L={note:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 14H6v-1.5h12V17zm0-3H6v-1.5h12V14zm0-3H6V9.5h12V11z"})}),article:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-1 4H6V5.5h12V7zm0 3H6V8.5h12V10zm0 3H6v-1.5h12V13zm-4 3H6v-1.5h8V16z"})}),reply:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M10 9V5l-7 7 7 7v-4.1c5 0 8.5 1.6 11 5.1-1-5-4-10-11-11z"})}),like:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),repost:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M7 7h10v3l4-4-4-4v3H5v6h2V7zm10 10H7v-3l-4 4 4 4v-3h12v-6h-2v4z"})}),bookmark:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M17 3H7c-1.1 0-2 .9-2 2v16l7-3 7 3V5c0-1.1-.9-2-2-2z"})}),rsvp:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zm-7.5-5l-3.5 3.5 1.5 1.5 2-2 4 4 1.5-1.5-5.5-5.5z"})}),checkin:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})}),listen:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"})}),watch:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M18 4l2 4h-3l-2-4h-2l2 4h-3l-2-4H8l2 4H7L5 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V4h-4z"})}),read:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M21 5c-1.11-.35-2.33-.5-3.5-.5-1.95 0-4.05.4-5.5 1.5-1.45-1.1-3.55-1.5-5.5-1.5S2.45 4.9 1 6v14.65c0 .25.25.5.5.5.1 0 .15-.05.25-.05C3.1 20.45 5.05 20 6.5 20c1.95 0 4.05.4 5.5 1.5 1.35-.85 3.8-1.5 5.5-1.5 1.65 0 3.35.3 4.75 1.05.1.05.15.05.25.05.25 0 .5-.25.5-.5V6c-.6-.45-1.25-.75-2-1zm0 13.5c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5V8c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5v11.5z"})}),event:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"})}),photo:()=>(0,A.jsxs)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,A.jsx)(S.Circle,{cx:"12",cy:"12",r:"3.2"}),(0,A.jsx)(S.Path,{d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})]}),video:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"})}),review:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"})}),recipe:()=>(0,A.jsx)(S.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,A.jsx)(S.Path,{d:"M11 9H9V2H7v7H5V2H3v7c0 2.12 1.66 3.84 3.75 3.97V22h2.5v-9.03C11.34 12.84 13 11.12 13 9V2h-2v7zm5-3v8h2.5v8H21V2c-2.76 0-5 2.24-5 4z"})})};function T({kinds:e,selectedKind:t,onSelect:n}){const i=(0,j.useRef)(null),s=(0,j.useCallback)((e,t)=>{const n=i.current?.querySelectorAll("button");if(!n||0===n.length)return;let s=t;switch(e.key){case"ArrowRight":s=t+1;break;case"ArrowLeft":s=t-1;break;case"ArrowDown":s=t+3;break;case"ArrowUp":s=t-3;break;case"Home":s=0;break;case"End":s=n.length-1;break;default:return}s<0?s=n.length-1:s>=n.length&&(s=0),e.preventDefault(),n[s]?.focus()},[]),a=[...e].sort((e,t)=>{const n=["note","article","reply","like","repost","bookmark","photo","video","rsvp","checkin","listen","watch","read","event","review"],i=n.indexOf(e.slug),s=n.indexOf(t.slug);return(-1===i?999:i)-(-1===s?999:s)});return(0,A.jsxs)("div",{ref:i,className:"reactions-indieweb-kind-grid",role:"radiogroup","aria-label":(0,f.__)("Select post kind","reactions-for-indieweb"),children:[a.map((e,i)=>{const a=L[e.slug]||L.note,r=e.slug===t;return(0,A.jsx)(y.Tooltip,{text:e.description||e.name,position:"bottom center",children:(0,A.jsxs)(y.Button,{className:"reactions-indieweb-kind-button "+(r?"is-selected":""),onClick:()=>n(e.slug),onKeyDown:e=>s(e,i),"aria-pressed":r,"aria-label":e.name,children:[(0,A.jsx)(a,{}),(0,A.jsx)("span",{className:"reactions-indieweb-kind-label",children:e.name}),r&&(0,A.jsx)(y.VisuallyHidden,{children:(0,f.__)("(selected)","reactions-for-indieweb")})]})},e.slug)}),(0,A.jsx)("style",{children:"\n\t\t\t\t.reactions-indieweb-kind-grid {\n\t\t\t\t\tdisplay: grid;\n\t\t\t\t\tgrid-template-columns: repeat(3, 1fr);\n\t\t\t\t\tgap: 8px;\n\t\t\t\t\tmargin-bottom: 16px;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-kind-button {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t\tpadding: 12px 8px;\n\t\t\t\t\tborder: 1px solid #ddd;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\tbackground: #fff;\n\t\t\t\t\tcursor: pointer;\n\t\t\t\t\ttransition: all 0.15s ease;\n\t\t\t\t\tmin-height: 70px;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-kind-button:hover {\n\t\t\t\t\tborder-color: #007cba;\n\t\t\t\t\tbackground: #f0f7fc;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-kind-button:focus {\n\t\t\t\t\toutline: 2px solid #007cba;\n\t\t\t\t\toutline-offset: 2px;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-kind-button.is-selected {\n\t\t\t\t\tborder-color: #007cba;\n\t\t\t\t\tbackground: #007cba;\n\t\t\t\t\tcolor: #fff;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-kind-button.is-selected:hover {\n\t\t\t\t\tbackground: #005a8c;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-kind-button svg {\n\t\t\t\t\twidth: 24px;\n\t\t\t\t\theight: 24px;\n\t\t\t\t\tmargin-bottom: 4px;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-kind-button.is-selected svg {\n\t\t\t\t\tfill: #fff;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-kind-label {\n\t\t\t\t\tfont-size: 11px;\n\t\t\t\t\ttext-align: center;\n\t\t\t\t\tline-height: 1.2;\n\t\t\t\t}\n\t\t\t"})]})}const V=(0,A.jsx)(S.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,A.jsx)(S.Path,{d:"M13 5c-3.3 0-6 2.7-6 6 0 1.4.5 2.7 1.3 3.7l-3.8 3.8 1.1 1.1 3.8-3.8c1 .8 2.3 1.3 3.7 1.3 3.3 0 6-2.7 6-6S16.3 5 13 5zm0 10.5c-2.5 0-4.5-2-4.5-4.5s2-4.5 4.5-4.5 4.5 2 4.5 4.5-2 4.5-4.5 4.5z"})});function K({kind:e}){const t=window.reactionsIndieWeb?.syndicationServices||{},i=Object.entries(t).filter(([,t])=>t.kind===e&&t.connected),s=(0,n.useSelect)(e=>{const t=e(r).getKindMeta,n={};return i.forEach(([e])=>{n[e]=t(`syndicate_${e}`)}),n},[i]),{updateKindMeta:a}=(0,n.useDispatch)(r);return 0===i.length?null:(0,A.jsxs)(y.__experimentalVStack,{spacing:2,className:"reactions-indieweb-syndication-controls",children:[(0,A.jsx)(y.PanelRow,{children:(0,A.jsx)("span",{className:"components-base-control__label",children:(0,f.__)("Syndication","reactions-for-indieweb")})}),i.map(([e,t])=>{const n=!1!==s[e];return(0,A.jsx)(y.ToggleControl,{label:t.name,help:n?(0,f.__)("Will sync on publish","reactions-for-indieweb"):(0,f.__)("Will not sync","reactions-for-indieweb"),checked:n,onChange:t=>a(`syndicate_${e}`,t)},e)})]})}function z({kind:e}){switch(e){case"rsvp":return(0,A.jsx)(D,{});case"checkin":return(0,A.jsx)(P,{});case"listen":return(0,A.jsx)(R,{});case"watch":return(0,A.jsx)(M,{});case"read":return(0,A.jsx)(N,{});case"event":return(0,A.jsx)(B,{});case"review":return(0,A.jsx)(I,{});case"reply":case"like":case"repost":case"bookmark":return(0,A.jsx)(E,{});default:return null}}function E(){const{citeName:e,citeUrl:t,citeAuthor:i,citeSummary:s}=(0,n.useSelect)(e=>{const t=e(r).getKindMeta;return{citeName:t("cite_name"),citeUrl:t("cite_url"),citeAuthor:t("cite_author"),citeSummary:t("cite_summary")}},[]),{updateKindMeta:a}=(0,n.useDispatch)(r);return(0,A.jsxs)(y.__experimentalVStack,{spacing:4,className:"reactions-indieweb-kind-fields",children:[(0,A.jsx)(y.TextControl,{label:(0,f.__)("URL","reactions-for-indieweb"),value:t,onChange:e=>a("cite_url",e),type:"url",placeholder:"https://"}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Title","reactions-for-indieweb"),value:e,onChange:e=>a("cite_name",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Author","reactions-for-indieweb"),value:i,onChange:e=>a("cite_author",e)}),(0,A.jsx)(y.TextareaControl,{label:(0,f.__)("Summary","reactions-for-indieweb"),value:s,onChange:e=>a("cite_summary",e),rows:3})]})}function D(){const{rsvpStatus:e,citeUrl:t,citeName:i}=(0,n.useSelect)(e=>{const t=e(r).getKindMeta;return{rsvpStatus:t("rsvp_status"),citeUrl:t("cite_url"),citeName:t("cite_name")}},[]),{updateKindMeta:s}=(0,n.useDispatch)(r);return(0,A.jsxs)(y.__experimentalVStack,{spacing:4,className:"reactions-indieweb-kind-fields",children:[(0,A.jsx)(y.TextControl,{label:(0,f.__)("Event URL","reactions-for-indieweb"),value:t,onChange:e=>s("cite_url",e),type:"url",placeholder:"https://"}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Event Name","reactions-for-indieweb"),value:i,onChange:e=>s("cite_name",e)}),(0,A.jsx)(y.SelectControl,{label:(0,f.__)("RSVP Status","reactions-for-indieweb"),value:e,onChange:e=>s("rsvp_status",e),options:[{label:(0,f.__)("Select statusâ€¦","reactions-for-indieweb"),value:""},{label:(0,f.__)("âœ… Yes, attending","reactions-for-indieweb"),value:"yes"},{label:(0,f.__)("âŒ No, can't make it","reactions-for-indieweb"),value:"no"},{label:(0,f.__)("ðŸ¤” Maybe","reactions-for-indieweb"),value:"maybe"},{label:(0,f.__)("ðŸ‘€ Interested","reactions-for-indieweb"),value:"interested"}]})]})}function P(){const{checkinName:e,checkinAddress:t,checkinLocality:i,checkinRegion:s,checkinCountry:a,geoLatitude:o,geoLongitude:l}=(0,n.useSelect)(e=>{const t=e(r).getKindMeta;return{checkinName:t("checkin_name"),checkinAddress:t("checkin_address"),checkinLocality:t("checkin_locality"),checkinRegion:t("checkin_region"),checkinCountry:t("checkin_country"),geoLatitude:t("geo_latitude"),geoLongitude:t("geo_longitude")}},[]),{updateKindMeta:c}=(0,n.useDispatch)(r);return(0,A.jsxs)(y.__experimentalVStack,{spacing:4,className:"reactions-indieweb-kind-fields",children:[(0,A.jsx)(y.TextControl,{label:(0,f.__)("Venue Name","reactions-for-indieweb"),value:e,onChange:e=>c("checkin_name",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Address","reactions-for-indieweb"),value:t,onChange:e=>c("checkin_address",e)}),(0,A.jsxs)(y.__experimentalHStack,{children:[(0,A.jsx)(y.TextControl,{label:(0,f.__)("City","reactions-for-indieweb"),value:i,onChange:e=>c("checkin_locality",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("State/Region","reactions-for-indieweb"),value:s,onChange:e=>c("checkin_region",e)})]}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Country","reactions-for-indieweb"),value:a,onChange:e=>c("checkin_country",e)}),(0,A.jsxs)(y.__experimentalHStack,{children:[(0,A.jsx)(y.TextControl,{label:(0,f.__)("Latitude","reactions-for-indieweb"),value:o,onChange:e=>c("geo_latitude",parseFloat(e)||0),type:"number",step:"0.0000001"}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Longitude","reactions-for-indieweb"),value:l,onChange:e=>c("geo_longitude",parseFloat(e)||0),type:"number",step:"0.0000001"})]})]})}function R(){const[e,t]=(0,j.useState)(""),{listenTrack:i,listenArtist:s,listenAlbum:a,listenCover:o,isLoading:l,apiResults:c}=(0,n.useSelect)(e=>{const t=e(r).getKindMeta,n=e(r);return{listenTrack:t("listen_track"),listenArtist:t("listen_artist"),listenAlbum:t("listen_album"),listenCover:t("listen_cover"),isLoading:n.isApiLoading(),apiResults:"music"===n.getApiLookupType()?n.getApiResults():[]}},[]),{updateKindMeta:d,performApiLookup:u,clearApiResults:h}=(0,n.useDispatch)(r),p=(0,j.useCallback)(()=>{e.trim()&&u("music",e)},[e,u]),w=(0,j.useCallback)(e=>{d("listen_track",e.track),d("listen_artist",e.artist),d("listen_album",e.album),d("listen_cover",e.cover),d("listen_mbid",e.mbid),h(),t("")},[d,h]);return(0,A.jsxs)(y.__experimentalVStack,{spacing:4,className:"reactions-indieweb-kind-fields",children:[(0,A.jsx)(y.BaseControl,{label:(0,f.__)("Search Music","reactions-for-indieweb"),children:(0,A.jsxs)(y.__experimentalHStack,{children:[(0,A.jsx)(y.TextControl,{value:e,onChange:t,placeholder:(0,f.__)("Track name or artistâ€¦","reactions-for-indieweb"),onKeyDown:e=>"Enter"===e.key&&p()}),(0,A.jsx)(y.Button,{icon:V,onClick:p,disabled:l,label:(0,f.__)("Search","reactions-for-indieweb")})]})}),l&&(0,A.jsx)(y.Spinner,{}),c.length>0&&(0,A.jsx)("div",{className:"reactions-indieweb-api-results",children:c.slice(0,5).map((e,t)=>(0,A.jsxs)(y.Button,{className:"reactions-indieweb-api-result",onClick:()=>w(e),children:[e.cover&&(0,A.jsx)("img",{src:e.cover,alt:"",width:"40",height:"40"}),(0,A.jsxs)("span",{children:[(0,A.jsx)("strong",{children:e.track}),(0,A.jsx)("br",{}),e.artist," â€” ",e.album]})]},t))}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Track","reactions-for-indieweb"),value:i,onChange:e=>d("listen_track",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Artist","reactions-for-indieweb"),value:s,onChange:e=>d("listen_artist",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Album","reactions-for-indieweb"),value:a,onChange:e=>d("listen_album",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Album Art URL","reactions-for-indieweb"),value:o,onChange:e=>d("listen_cover",e),type:"url"}),(0,A.jsx)(K,{kind:"listen"})]})}function M(){const[e,t]=(0,j.useState)(""),{watchTitle:i,watchYear:s,watchPoster:a,watchStatus:o,watchSpoilers:l,isLoading:c,apiResults:d}=(0,n.useSelect)(e=>{const t=e(r).getKindMeta,n=e(r);return{watchTitle:t("watch_title"),watchYear:t("watch_year"),watchPoster:t("watch_poster"),watchStatus:t("watch_status"),watchSpoilers:t("watch_spoilers"),isLoading:n.isApiLoading(),apiResults:"movie"===n.getApiLookupType()?n.getApiResults():[]}},[]),{updateKindMeta:u,performApiLookup:h,clearApiResults:p}=(0,n.useDispatch)(r),w=(0,j.useCallback)(()=>{e.trim()&&h("movie",e)},[e,h]),b=(0,j.useCallback)(e=>{u("watch_title",e.title),u("watch_year",e.year),u("watch_poster",e.poster),u("watch_tmdb_id",e.tmdb_id),p(),t("")},[u,p]);return(0,A.jsxs)(y.__experimentalVStack,{spacing:4,className:"reactions-indieweb-kind-fields",children:[(0,A.jsx)(y.BaseControl,{label:(0,f.__)("Search Movies/TV","reactions-for-indieweb"),children:(0,A.jsxs)(y.__experimentalHStack,{children:[(0,A.jsx)(y.TextControl,{value:e,onChange:t,placeholder:(0,f.__)("Titleâ€¦","reactions-for-indieweb"),onKeyDown:e=>"Enter"===e.key&&w()}),(0,A.jsx)(y.Button,{icon:V,onClick:w,disabled:c,label:(0,f.__)("Search","reactions-for-indieweb")})]})}),c&&(0,A.jsx)(y.Spinner,{}),d.length>0&&(0,A.jsx)("div",{className:"reactions-indieweb-api-results",children:d.slice(0,5).map((e,t)=>(0,A.jsxs)(y.Button,{className:"reactions-indieweb-api-result",onClick:()=>b(e),children:[e.poster&&(0,A.jsx)("img",{src:e.poster,alt:"",width:"30",height:"45"}),(0,A.jsxs)("span",{children:[(0,A.jsx)("strong",{children:e.title})," (",e.year,")"]})]},t))}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Title","reactions-for-indieweb"),value:i,onChange:e=>u("watch_title",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Year","reactions-for-indieweb"),value:s,onChange:e=>u("watch_year",e)}),(0,A.jsx)(y.SelectControl,{label:(0,f.__)("Status","reactions-for-indieweb"),value:o,onChange:e=>u("watch_status",e),options:[{label:(0,f.__)("Watched","reactions-for-indieweb"),value:"watched"},{label:(0,f.__)("Currently Watching","reactions-for-indieweb"),value:"watching"},{label:(0,f.__)("Abandoned","reactions-for-indieweb"),value:"abandoned"}]}),(0,A.jsx)(y.ToggleControl,{label:(0,f.__)("Contains spoilers","reactions-for-indieweb"),checked:l,onChange:e=>u("watch_spoilers",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Poster URL","reactions-for-indieweb"),value:a,onChange:e=>u("watch_poster",e),type:"url"}),(0,A.jsx)(K,{kind:"watch"})]})}function N(){const[e,t]=(0,j.useState)(""),{readTitle:i,readAuthor:s,readIsbn:a,readCover:o,readStatus:l,readProgress:c,readPages:d,isLoading:u,apiResults:h}=(0,n.useSelect)(e=>{const t=e(r).getKindMeta,n=e(r);return{readTitle:t("read_title"),readAuthor:t("read_author"),readIsbn:t("read_isbn"),readCover:t("read_cover"),readStatus:t("read_status"),readProgress:t("read_progress"),readPages:t("read_pages"),isLoading:n.isApiLoading(),apiResults:"book"===n.getApiLookupType()?n.getApiResults():[]}},[]),{updateKindMeta:p,performApiLookup:w,clearApiResults:b}=(0,n.useDispatch)(r),x=(0,j.useCallback)(()=>{e.trim()&&w("book",e)},[e,w]),_=(0,j.useCallback)(e=>{p("read_title",e.title),p("read_author",e.author),p("read_isbn",e.isbn),p("read_cover",e.cover),p("read_pages",e.pages||0),b(),t("")},[p,b]);return(0,A.jsxs)(y.__experimentalVStack,{spacing:4,className:"reactions-indieweb-kind-fields",children:[(0,A.jsx)(y.BaseControl,{label:(0,f.__)("Search Books","reactions-for-indieweb"),children:(0,A.jsxs)(y.__experimentalHStack,{children:[(0,A.jsx)(y.TextControl,{value:e,onChange:t,placeholder:(0,f.__)("Title or ISBNâ€¦","reactions-for-indieweb"),onKeyDown:e=>"Enter"===e.key&&x()}),(0,A.jsx)(y.Button,{icon:V,onClick:x,disabled:u,label:(0,f.__)("Search","reactions-for-indieweb")})]})}),u&&(0,A.jsx)(y.Spinner,{}),h.length>0&&(0,A.jsx)("div",{className:"reactions-indieweb-api-results",children:h.slice(0,5).map((e,t)=>(0,A.jsxs)(y.Button,{className:"reactions-indieweb-api-result",onClick:()=>_(e),children:[e.cover&&(0,A.jsx)("img",{src:e.cover,alt:"",width:"30",height:"45"}),(0,A.jsxs)("span",{children:[(0,A.jsx)("strong",{children:e.title}),(0,A.jsx)("br",{}),e.author]})]},t))}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Title","reactions-for-indieweb"),value:i,onChange:e=>p("read_title",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Author","reactions-for-indieweb"),value:s,onChange:e=>p("read_author",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("ISBN","reactions-for-indieweb"),value:a,onChange:e=>p("read_isbn",e)}),(0,A.jsx)(y.SelectControl,{label:(0,f.__)("Status","reactions-for-indieweb"),value:l,onChange:e=>p("read_status",e),options:[{label:(0,f.__)("To Read","reactions-for-indieweb"),value:"to-read"},{label:(0,f.__)("Currently Reading","reactions-for-indieweb"),value:"reading"},{label:(0,f.__)("Finished","reactions-for-indieweb"),value:"finished"},{label:(0,f.__)("Abandoned","reactions-for-indieweb"),value:"abandoned"}]}),(0,A.jsxs)(y.__experimentalHStack,{children:[(0,A.jsx)(y.TextControl,{label:(0,f.__)("Current Page","reactions-for-indieweb"),value:c,onChange:e=>p("read_progress",parseInt(e,10)||0),type:"number",min:"0"}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Total Pages","reactions-for-indieweb"),value:d,onChange:e=>p("read_pages",parseInt(e,10)||0),type:"number",min:"0"})]}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Cover URL","reactions-for-indieweb"),value:o,onChange:e=>p("read_cover",e),type:"url"})]})}function B(){const{eventStart:e,eventEnd:t,eventLocation:i,eventUrl:s}=(0,n.useSelect)(e=>{const t=e(r).getKindMeta;return{eventStart:t("event_start"),eventEnd:t("event_end"),eventLocation:t("event_location"),eventUrl:t("event_url")}},[]),{updateKindMeta:a}=(0,n.useDispatch)(r);return(0,A.jsxs)(y.__experimentalVStack,{spacing:4,className:"reactions-indieweb-kind-fields",children:[(0,A.jsx)(y.TextControl,{label:(0,f.__)("Start Date/Time","reactions-for-indieweb"),value:e,onChange:e=>a("event_start",e),type:"datetime-local"}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("End Date/Time","reactions-for-indieweb"),value:t,onChange:e=>a("event_end",e),type:"datetime-local"}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Location","reactions-for-indieweb"),value:i,onChange:e=>a("event_location",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Event URL","reactions-for-indieweb"),value:s,onChange:e=>a("event_url",e),type:"url",placeholder:"https://"})]})}function I(){const{reviewRating:e,reviewBest:t,reviewItemName:i,reviewItemUrl:s}=(0,n.useSelect)(e=>{const t=e(r).getKindMeta;return{reviewRating:t("review_rating"),reviewBest:t("review_best")||5,reviewItemName:t("review_item_name"),reviewItemUrl:t("review_item_url")}},[]),{updateKindMeta:a}=(0,n.useDispatch)(r),o=parseFloat(e)||0,l=parseInt(t,10)||5,c=[];for(let e=1;e<=l;e++)e<=o?c.push("â˜…"):e-.5===o?c.push("Â½"):c.push("â˜†");return(0,A.jsxs)(y.__experimentalVStack,{spacing:4,className:"reactions-indieweb-kind-fields",children:[(0,A.jsx)(y.TextControl,{label:(0,f.__)("Item Name","reactions-for-indieweb"),value:i,onChange:e=>a("review_item_name",e)}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Item URL","reactions-for-indieweb"),value:s,onChange:e=>a("review_item_url",e),type:"url",placeholder:"https://"}),(0,A.jsx)(y.BaseControl,{label:(0,f.__)("Rating","reactions-for-indieweb"),children:(0,A.jsxs)("div",{className:"reactions-indieweb-star-rating",children:[(0,A.jsx)("span",{className:"reactions-indieweb-stars","aria-hidden":"true",children:c.join("")}),(0,A.jsx)(y.RangeControl,{value:o,onChange:e=>a("review_rating",e),min:0,max:l,step:.5,withInputField:!0})]})}),(0,A.jsx)(y.TextControl,{label:(0,f.__)("Maximum Rating","reactions-for-indieweb"),value:t,onChange:e=>a("review_best",parseInt(e,10)||5),type:"number",min:"1",max:"10"}),(0,A.jsx)("style",{children:"\n\t\t\t\t.reactions-indieweb-star-rating .reactions-indieweb-stars {\n\t\t\t\t\tfont-size: 24px;\n\t\t\t\t\tcolor: #f5a623;\n\t\t\t\t\tmargin-bottom: 8px;\n\t\t\t\t\tdisplay: block;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-api-results {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tflex-direction: column;\n\t\t\t\t\tgap: 4px;\n\t\t\t\t\tmax-height: 200px;\n\t\t\t\t\toverflow-y: auto;\n\t\t\t\t\tborder: 1px solid #ddd;\n\t\t\t\t\tborder-radius: 4px;\n\t\t\t\t\tpadding: 4px;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-api-result {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\talign-items: center;\n\t\t\t\t\tgap: 8px;\n\t\t\t\t\tpadding: 8px;\n\t\t\t\t\ttext-align: left;\n\t\t\t\t\twidth: 100%;\n\t\t\t\t\tjustify-content: flex-start;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-api-result img {\n\t\t\t\t\tflex-shrink: 0;\n\t\t\t\t\tobject-fit: cover;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-api-result span {\n\t\t\t\t\toverflow: hidden;\n\t\t\t\t\ttext-overflow: ellipsis;\n\t\t\t\t}\n\t\t\t"})]})}const H=(0,A.jsx)(S.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,A.jsx)(S.Path,{d:"M16.7 7.1l-6.3 8.5-3.3-2.5-.9 1.2 4.5 3.4L17.9 8z"})}),U=(0,A.jsx)(S.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,A.jsx)(S.Path,{d:"M12 13.06l3.712 3.713 1.061-1.06L13.061 12l3.712-3.712-1.06-1.06L12 10.938 8.288 7.227l-1.061 1.06L10.939 12l-3.712 3.712 1.06 1.061L12 13.061z"})});function G({detectedKind:e,kindLabel:t,onAccept:n,onDismiss:i}){return(0,A.jsxs)(y.Notice,{status:"info",isDismissible:!1,className:"reactions-indieweb-auto-detect-notice",children:[(0,A.jsxs)("p",{children:[(0,f.__)("Auto-detected as:","reactions-for-indieweb")," ",(0,A.jsx)("strong",{children:t})]}),(0,A.jsxs)("div",{className:"reactions-indieweb-auto-detect-actions",children:[(0,A.jsx)(y.Button,{variant:"primary",size:"small",icon:H,onClick:n,children:(0,f.__)("Use this","reactions-for-indieweb")}),(0,A.jsx)(y.Button,{variant:"secondary",size:"small",icon:U,onClick:i,children:(0,f.__)("Choose different","reactions-for-indieweb")})]}),(0,A.jsx)("style",{children:"\n\t\t\t\t.reactions-indieweb-auto-detect-notice {\n\t\t\t\t\tmargin-bottom: 16px;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-auto-detect-notice p {\n\t\t\t\t\tmargin: 0 0 8px 0;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-auto-detect-actions {\n\t\t\t\t\tdisplay: flex;\n\t\t\t\t\tgap: 8px;\n\t\t\t\t}\n\n\t\t\t\t.reactions-indieweb-auto-detect-actions .components-button {\n\t\t\t\t\tjustify-content: center;\n\t\t\t\t}\n\t\t\t"})]})}const O={"indieblocks/reply":"reply","indieblocks/like":"like","indieblocks/repost":"repost","indieblocks/bookmark":"bookmark","core/gallery":"photo","core/image":"photo","core/video":"video","core/audio":"listen"};function F(e,t){for(const n of e){if(O[n.name])return O[n.name];if(n.innerBlocks&&n.innerBlocks.length>0){const e=F(n.innerBlocks,t);if(e)return e}}const n=e.some(e=>"core/gallery"===e.name),i=e.filter(e=>"core/image"===e.name).length,s=e.some(e=>"core/video"===e.name);return n||i>=3?"photo":s?"video":t&&t.trim().length>0?"article":"note"}(0,n.register)(k),(0,t.registerPlugin)("reactions-indieweb-kind-selector",{render:function(){const{selectedKind:e,autoDetectedKind:t,isAutoDetectionEnabled:i,availableKinds:s,isInitialized:o,postTitle:l,blocks:c}=(0,n.useSelect)(e=>{const t=e(r),n=e(a.store),i=e(C.store);return{selectedKind:t.getSelectedKind(),autoDetectedKind:t.getAutoDetectedKind(),isAutoDetectionEnabled:t.isAutoDetectionEnabled(),availableKinds:t.getAvailableKinds(),isInitialized:t.isInitialized(),postTitle:n.getEditedPostAttribute("title"),blocks:i.getBlocks()}},[]),{initialize:d,setAutoDetectedKind:u,updatePostKind:h,disableAutoDetection:p}=(0,n.useDispatch)(r);(0,j.useEffect)(()=>{o||d()},[o,d]),(0,j.useEffect)(()=>{if(!i||e)return;const t=F(c,l);u(t)},[c,l,i,e,u]);const w=e||t||"note",b=s.find(e=>e.slug===w),x=L[w]||L.note;return(0,A.jsxs)(a.PluginDocumentSettingPanel,{name:"reactions-indieweb-kind-selector",title:(0,f.__)("Post Kind","reactions-for-indieweb"),className:"reactions-indieweb-kind-panel",icon:(0,A.jsx)(x,{}),children:[!e&&t&&(0,A.jsx)(G,{detectedKind:t,kindLabel:b?.name||t,onAccept:function(){t&&(h(t),p())},onDismiss:()=>u(null)}),(0,A.jsx)(T,{kinds:s,selectedKind:w,onSelect:function(e){h(e),p()}}),w&&(0,A.jsx)(z,{kind:w})]})},icon:null}),window.addEventListener("reactions-indieweb-set-kind",e=>{const{kind:t}=e.detail||{};t&&(0,n.select)(r)&&(0,n.dispatch)(r).updatePostKind(t)})})();